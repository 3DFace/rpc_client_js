!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("promise")):"function"==typeof define&&define.amd?define("rpc_client",["promise"],n):"object"==typeof exports?exports.rpc_client=n(require("promise")):e.rpc_client=n(e.promise)}(this,function(e){return function(e){function n(r){if(t[r])return t[r].e;var o=t[r]={e:{},i:r,l:!1};return e[r].call(o.e,o,o.e,n),o.l=!0,o.e}var t={};return n.m=e,n.c=t,n.p="",n(n.s=8)}([function(n,t){n.e=e},function(e,n,t){var r;r=function(e){function n(e){this.send=function(n){return new r(function(t,r){var o=new XMLHttpRequest;o.open("POST",e,!0),o.withCredentials=!0,o.onload=function(){this.status>=200&&this.status<300?t(o.response):r({status:this.status,statusText:o.statusText})},o.onerror=function(){r({status:this.status,statusText:o.statusText})},o.send(n)})}}var r=t(0);return n}.call(n,t,n,e),!(void 0!==r&&(e.e=r))},function(e,n,t){var r;r=function(){function e(e,n,t){this.send=function(r){r=n?n(r):r;var o=e.send(r);return t?t(o):o}}return e}.call(n,t,n,e),!(void 0!==r&&(e.e=r))},function(e,n,t){var r;r=function(e){function n(e){this.send=function(n){return new r(function(t,r){try{var o=JSON.stringify(n);e.send(o).then(function(e){try{var n=JSON.parse(e)}catch(o){r({name:"JsonLayerError",message:o.name+": "+o.message+"\n"+e})}t(n)},r)}catch(u){r({name:"JsonLayerError",message:u.name+": "+u.message})}})}}var r=t(0);return n}.call(n,t,n,e),!(void 0!==r&&(e.e=r))},function(e,n,t){var r;r=function(e){function n(e,n,t,r){this.send=function(o){var u,a;if(n)for(u=0;u<o.length;u++)a=o[u],n("call["+u+"]",a[0]+"->"+a[1]+"("+(a[2]&&a[2].join(", ")||"")+")");var i=e.send(o);if(t||r){var c=new Array(i.length);for(u=0;u<i.length;u++)!function(e){c[e]=i[e].then(function(n){return t&&t("result["+e+"]",n),n},function(n){var o=r||t;throw o&&o("error["+e+"]",n),n})}(u);return c}return i}}return n}.call(n,t,n,e),!(void 0!==r&&(e.e=r))},function(e,n,t){var r;r=function(e){function n(e){if("object"!=typeof e)throw{name:"RpcProtocolError",message:"Bad response format: object expected, got "+typeof e};if(void 0===e.status)throw{name:"RpcProtocolError",message:"no status"};if(void 0===e.result)throw{name:"RpcProtocolError",message:"no result"};if(!e.status)throw{name:e.result.type||"UnknownError",message:e.result.message||""};return e.result}function r(e){var t=1;this.send=function(r){var u,a,i=new Array(r.length),c=[];if(r.length>0){var f=new Array(r.length);for(u=0;u<r.length;u++)a=r[u],f[u]={service:a[0],method:a[1]},a[2]&&a[2].length>0&&(f[u].parameters=a[2]),i[u]=new o(function(e,n){c.push([e,n])});var s={id:t++,calls:f};e.send(s).then(function(e){try{var t=n(e);for(u=0;u<c.length;u++)try{var r=n(t[u]);c[u][0](r)}catch(o){c[u][1](o)}}catch(o){for(u=0;u<c.length;u++)c[u][1](o)}},function(e){for(u=0;u<c.length;u++)c[u][1](e)})}return i}}var o=t(0);return r}.call(n,t,n,e),!(void 0!==r&&(e.e=r))},function(e,n,t){var r;r=function(e){function n(e){var t=this;t.call=function(n,t,r){return e.send([[n,t,r]])[0]},t.batch=function(t){var o=new r,u=new n(o);return t(u),o.flush(e)}}var r=t(7);return n}.call(n,t,n,e),!(void 0!==r&&(e.e=r))},function(e,n,t){var r;r=function(e){function n(){var e,n=this,t=[],o=[];n.send=function(n){var u=new Array(n.length);for(t=t.concat(n),e=0;e<n.length;e++)u[e]=new r(function(e,n){o.push([e,n])});return u},n.flush=function(e){for(var n=e.send(t),r=new Array(n.length),u=0;u<o.length;u++)r[u]=n[u].then(o[u][0],o[1]);return r}}var r=t(0);return n}.call(n,t,n,e),!(void 0!==r&&(e.e=r))},function(e,n,t){var r=t(1),o=r&&r.__esModule?function(){return r["default"]}:function(){return r};Object.defineProperty(o,"a",{get:o});var u=t(4),a=u&&u.__esModule?function(){return u["default"]}:function(){return u};Object.defineProperty(a,"a",{get:a});var i=t(3),c=i&&i.__esModule?function(){return i["default"]}:function(){return i};Object.defineProperty(c,"a",{get:c});var f=t(2),s=f&&f.__esModule?function(){return f["default"]}:function(){return f};Object.defineProperty(s,"a",{get:s});var l=t(5),d=l&&l.__esModule?function(){return l["default"]}:function(){return l};Object.defineProperty(d,"a",{get:d});var v=t(6),h=v&&v.__esModule?function(){return v["default"]}:function(){return v};Object.defineProperty(h,"a",{get:h}),Object.defineProperty(n,"RpcClient",{configurable:!1,enumerable:!0,get:function(){return h.a}}),Object.defineProperty(n,"AjaxLayer",{configurable:!1,enumerable:!0,get:function(){return o.a}}),Object.defineProperty(n,"LogLayer",{configurable:!1,enumerable:!0,get:function(){return a.a}}),Object.defineProperty(n,"JsonLayer",{configurable:!1,enumerable:!0,get:function(){return c.a}}),Object.defineProperty(n,"HookLayer",{configurable:!1,enumerable:!0,get:function(){return s.a}}),Object.defineProperty(n,"ProtocolLayer",{configurable:!1,enumerable:!0,get:function(){return d.a}})}])});
//# sourceMappingURL=rpc_client.js.map