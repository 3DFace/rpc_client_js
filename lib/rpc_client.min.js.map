{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///rpc_client.min.js","webpack:///webpack/bootstrap 3c316361b19bcdcf5128","webpack:///./src/AjaxLayer.js","webpack:///./src/HookLayer.js","webpack:///./src/JsonLayer.js","webpack:///./src/LogLayer.js","webpack:///./src/ProtocolLayer.js","webpack:///./src/RequestLayer.js","webpack:///./src/RpcClient.js","webpack:///./src/BatchLayer.js","webpack:///./src/index.js","webpack:///external \"request\""],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_9__","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","value","d","name","getter","Object","defineProperty","configurable","enumerable","get","o","object","property","prototype","hasOwnProperty","p","s","AjaxLayer","url","pre_request_fn","post_request_fn","send","request_str","Promise","resolve","reject","xhr","XMLHttpRequest","open","withCredentials","onload","status","response","statusText","onerror","HookLayer","protocol_layer","pre_fn","post_fn","calls","promises","JsonLayer","text_transport_layer","request","json","JSON","stringify","then","json_response","parse","e","message","code","LogLayer","log_request_fn","log_response_fn","log_error_fn","length","join","error","logger","extractResult","undefined","ProtocolLayer","json_layer","id","Array","callbacks","formed_calls","service","method","parameters","push","result","r","RequestLayer","requestOptions","uri","body","jar","__WEBPACK_IMPORTED_MODULE_0_request___default","statusCode","__WEBPACK_IMPORTED_MODULE_0_request__","__esModule","RpcClient","client","params","batch","callback","batchLayer","__WEBPACK_IMPORTED_MODULE_0__BatchLayer__","batchClient","flush","BatchLayer","layer","calls_acc","callbacks_acc","concat","CreateNodeRpcClient","options","httpOpt","http","httpLayer","__WEBPACK_IMPORTED_MODULE_6__RequestLayer__","pre_request","post_request","jsonLayer","__WEBPACK_IMPORTED_MODULE_2__JsonLayer__","protocolLayer","__WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__","lo","log","logLayer","__WEBPACK_IMPORTED_MODULE_1__LogLayer__","__WEBPACK_IMPORTED_MODULE_5__RpcClient__","CreateBrowserRpcClient","__WEBPACK_IMPORTED_MODULE_0__AjaxLayer__","__WEBPACK_IMPORTED_MODULE_3__HookLayer__"],"mappings":"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","file":"rpc_client.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"request\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"rpc_client\", [\"request\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"rpc_client\"] = factory(require(\"request\"));\n\telse\n\t\troot[\"rpc_client\"] = factory(root[\"request\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_9__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"request\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"rpc_client\", [\"request\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"rpc_client\"] = factory(require(\"request\"));\n\telse\n\t\troot[\"rpc_client\"] = factory(root[\"request\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_9__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmory imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmory exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tObject.defineProperty(exports, name, {\n/******/ \t\t\tconfigurable: false,\n/******/ \t\t\tenumerable: true,\n/******/ \t\t\tget: getter\n/******/ \t\t});\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 8);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t/**\n\t * @param {string} url RPC-server URL\n\t * @param {function} pre_request_fn hook fn(xhr)\n\t * @param {function} post_request_fn hook fn(xhr)\n\t * @constructor\n\t */\n\t\n\tfunction AjaxLayer(url, pre_request_fn, post_request_fn){\n\t\n\t\tthis.send = function(request_str){\n\t\n\t\t\treturn new Promise(function(resolve, reject){\n\t\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\t\txhr.open(\"POST\", url, true);\n\t\t\t\txhr.withCredentials = true;\n\t\t\t\tpre_request_fn && pre_request_fn(xhr);\n\t\n\t\t\t\txhr.onload = function(){\n\t\t\t\t\tpost_request_fn && post_request_fn(xhr, true);\n\t\t\t\t\tif(this.status >= 200 && this.status < 300){\n\t\t\t\t\t\tresolve(xhr.response);\n\t\t\t\t\t}else{\n\t\t\t\t\t\treject({\n\t\t\t\t\t\t\tstatus: this.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\t\n\t\t\t\txhr.onerror = function(){\n\t\t\t\t\tpost_request_fn && post_request_fn(xhr, false);\n\t\t\t\t\treject({\n\t\t\t\t\t\tstatus: this.status,\n\t\t\t\t\t\tstatusText: xhr.statusText\n\t\t\t\t\t});\n\t\t\t\t};\n\t\n\t\t\t\txhr.send(request_str);\n\t\t\t});\n\t\n\t\t}\n\t}\n\t\n\t/* harmony default export */ exports[\"a\"] = AjaxLayer;\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t/**\n\t * @param protocol_layer\n\t * @param {function} pre_fn\n\t * @param {function} post_fn\n\t * @constructor\n\t */\n\tfunction HookLayer(protocol_layer, pre_fn, post_fn){\n\t\tthis.send = function(calls){\n\t\t\tcalls = pre_fn ? pre_fn(calls) : calls;\n\t\t\tvar promises = protocol_layer.send(calls);\n\t\t\treturn post_fn ? post_fn(promises) : promises;\n\t\t}\n\t}\n\t\n\t/* harmony default export */ exports[\"a\"] = HookLayer;\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t/**\n\t * @param {object} text_transport_layer\n\t * @constructor\n\t */\n\tfunction JsonLayer(text_transport_layer){\n\t\n\t\tthis.send = function(request){\n\t\n\t\t\treturn new Promise(function(resolve, reject){\n\t\t\t\ttry{\n\t\t\t\t\tvar json = JSON.stringify(request);\n\t\n\t\t\t\t\ttext_transport_layer.send(json).then(function(json_response){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tvar response = JSON.parse(json_response);\n\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\treject({\n\t\t\t\t\t\t\t\tname: \"JsonLayerError\",\n\t\t\t\t\t\t\t\tmessage: e.name + \": \" + e.message + \"\\n\" + json_response,\n\t\t\t\t\t\t\t\tcode: 1\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t}, reject);\n\t\t\t\t}catch(e){\n\t\t\t\t\treject({\n\t\t\t\t\t\tname: \"JsonLayerError\",\n\t\t\t\t\t\tmessage: e.name + \": \" + e.message,\n\t\t\t\t\t\tcode: 1\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\t\n\t/* harmony default export */ exports[\"a\"] = JsonLayer;\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t/**\n\t * @param {object} protocol_layer\n\t * @param {function} log_request_fn\n\t * @param {function} log_response_fn\n\t * @param {function} log_error_fn\n\t * @constructor\n\t */\n\tfunction LogLayer(protocol_layer, log_request_fn, log_response_fn, log_error_fn){\n\t\n\t\tthis.send = function(calls){\n\t\n\t\t\tvar i, call;\n\t\t\tif(log_request_fn){\n\t\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\t\tcall = calls[i];\n\t\t\t\t\tlog_request_fn(\"call[\" + i + \"]\", call[0] + '->' + call[1] + '(' + (call[2] && call[2].join(', ') || '') + ')');\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tvar promises = protocol_layer.send(calls);\n\t\n\t\t\tif(log_response_fn || log_error_fn){\n\t\t\t\tfor(i = 0; i < promises.length; i++){\n\t\t\t\t\t(function(i){\n\t\t\t\t\t\tpromises[i].then(function(response){\n\t\t\t\t\t\t\tlog_response_fn && log_response_fn(\"result[\" + i + \"]\", response);\n\t\t\t\t\t\t\treturn response;\n\t\t\t\t\t\t}, function(error){\n\t\t\t\t\t\t\tvar logger = log_error_fn || log_response_fn;\n\t\t\t\t\t\t\tlogger && logger(\"error[\" + i + \"]\", error);\n\t\t\t\t\t\t})\n\t\t\t\t\t})(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn promises;\n\t\t}\n\t}\n\t\n\t/* harmony default export */ exports[\"a\"] = LogLayer;\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\tfunction extractResult(response){\n\t\tif(typeof response !== \"object\"){\n\t\t\tthrow {name: \"RpcProtocolError\", message: \"Bad response format: object expected, got \" + (typeof response), code: 1};\n\t\t}\n\t\tif(response[\"status\"] === undefined){\n\t\t\tthrow {name: \"RpcProtocolError\", message: \"no status\", code: 1};\n\t\t}\n\t\tif(response[\"result\"] === undefined){\n\t\t\tthrow {name: \"RpcProtocolError\", message: \"no result\", code: 1};\n\t\t}\n\t\tif(!response[\"status\"]){\n\t\t\tthrow {name: response[\"result\"][\"type\"] || \"UnknownError\", message: response[\"result\"][\"message\"] || \"\", code: response[\"result\"][\"code\"] || 0};\n\t\t}\n\t\treturn response[\"result\"];\n\t}\n\t\n\t/**\n\t * @param {object} json_layer\n\t * @constructor\n\t */\n\tfunction ProtocolLayer(json_layer){\n\t\n\t\tvar id = 1;\n\t\n\t\tthis.send = function(calls){\n\t\n\t\t\tvar i, call;\n\t\t\tvar promises = new Array(calls.length);\n\t\t\tvar callbacks = [];\n\t\t\tif(calls.length > 0){\n\t\n\t\t\t\tvar formed_calls = new Array(calls.length);\n\t\n\t\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\t\tcall = calls[i];\n\t\t\t\t\tformed_calls[i] = {\n\t\t\t\t\t\tservice: call[0],\n\t\t\t\t\t\tmethod: call[1]\n\t\t\t\t\t};\n\t\t\t\t\tif(call[2] && call[2].length > 0){\n\t\t\t\t\t\tformed_calls[i].parameters = call[2];\n\t\t\t\t\t}\n\t\t\t\t\tpromises[i] = new Promise(function(resolve, reject){\n\t\t\t\t\t\tcallbacks.push([resolve, reject]);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\n\t\t\t\tvar request = {\n\t\t\t\t\tid: id++,\n\t\t\t\t\tcalls: formed_calls\n\t\t\t\t};\n\t\n\t\t\t\tjson_layer.send(request).then(function(response){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tvar result = extractResult(response);\n\t\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\tvar r = extractResult(result[i]);\n\t\t\t\t\t\t\t\tcallbacks[i][0](r);\n\t\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, function(e){\n\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn promises;\n\t\t}\n\t\n\t}\n\t\n\t/* harmony default export */ exports[\"a\"] = ProtocolLayer;\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_request__ = __webpack_require__(9);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_request___default = __WEBPACK_IMPORTED_MODULE_0_request__ && __WEBPACK_IMPORTED_MODULE_0_request__.__esModule ? function() { return __WEBPACK_IMPORTED_MODULE_0_request__['default'] } : function() { return __WEBPACK_IMPORTED_MODULE_0_request__; };\n\t/* harmony import */ __webpack_require__.d(__WEBPACK_IMPORTED_MODULE_0_request___default, 'a', __WEBPACK_IMPORTED_MODULE_0_request___default);\n\t/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t\n\t\n\t/**\n\t* @param {string} url RPC-server URL\n\t* @param {?object} options for 'request' lib\n\t* @param {?function} pre_request_fn hook fn(requestOptions)\n\t* @param {?function} post_request_fn hook fn(response, successful)\n\t* @constructor\n\t*/\n\tfunction RequestLayer(url, pre_request_fn, post_request_fn){\n\t\n\t\tthis.send = function(request_str){\n\t\n\t\t\treturn new Promise(function(resolve, reject){\n\t\n\t\t\t\tvar requestOptions = {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\turi: url,\n\t\t\t\t\tbody: request_str,\n\t\t\t\t\tjar: true\n\t\t\t\t};\n\t\n\t\t\t\tpre_request_fn && pre_request_fn(requestOptions);\n\t\n\t\t\t\t__WEBPACK_IMPORTED_MODULE_0_request___default()(requestOptions, function(error, response, body){\n\t\t\t\t\t\tvar status = response.statusCode;\n\t\t\t\t\t\tif(!error && status >= 200 && status < 300){\n\t\t\t\t\t\t\tpost_request_fn && post_request_fn(response, true);\n\t\t\t\t\t\t\tresolve(body);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tpost_request_fn && post_request_fn(response, false);\n\t\t\t\t\t\t\treject({\n\t\t\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\t\t\terror: error\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\n\t\t}\n\t}\n\t\n\t/* harmony default export */ exports[\"a\"] = RequestLayer;\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__BatchLayer__ = __webpack_require__(7);\n\t/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t\n\t\n\t/**\n\t * @param {object} protocol_layer\n\t * @constructor\n\t */\n\tfunction RpcClient(protocol_layer){\n\t\n\t\tvar client = this;\n\t\n\t\tclient.call = function(service, method, params){\n\t\t\treturn protocol_layer.send([[service, method, params]])[0];\n\t\t};\n\t\n\t\tclient.batch = function(callback){\n\t\t\tvar batchLayer = new __WEBPACK_IMPORTED_MODULE_0__BatchLayer__[\"a\" /* default */]();\n\t\t\tvar batchClient = new RpcClient(batchLayer);\n\t\t\tcallback(batchClient);\n\t\t\treturn batchLayer.flush(protocol_layer);\n\t\t};\n\t\n\t}\n\t\n\t/* harmony default export */ exports[\"a\"] = RpcClient;\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t/**\n\t * @constructor\n\t */\n\tfunction BatchLayer(){\n\t\n\t\tvar layer = this;\n\t\tvar i, calls_acc = [], callbacks_acc = [];\n\t\n\t\tlayer.send = function(calls){\n\t\t\tvar promises = new Array(calls.length);\n\t\t\tcalls_acc = calls_acc.concat(calls);\n\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\tpromises[i] = new Promise(function(resolve, reject){\n\t\t\t\t\tcallbacks_acc.push([resolve, reject]);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn promises;\n\t\t};\n\t\n\t\tlayer.flush = function(protocol_layer){\n\t\t\tvar promises = protocol_layer.send(calls_acc);\n\t\t\tfor(var i = 0; i < callbacks_acc.length; i++){\n\t\t\t\tpromises[i].then(callbacks_acc[i][0], callbacks_acc[i][1]);\n\t\t\t}\n\t\t\treturn promises;\n\t\t};\n\t\n\t}\n\t\n\t/* harmony default export */ exports[\"a\"] = BatchLayer;\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__AjaxLayer__ = __webpack_require__(0);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__LogLayer__ = __webpack_require__(3);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__JsonLayer__ = __webpack_require__(2);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__HookLayer__ = __webpack_require__(1);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__ = __webpack_require__(4);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__RpcClient__ = __webpack_require__(6);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__RequestLayer__ = __webpack_require__(5);\n\t\n\t/* harmony export */ __webpack_require__.d(exports, \"CreateBrowserRpcClient\", function() { return CreateBrowserRpcClient; });\n\t/* harmony export */ __webpack_require__.d(exports, \"CreateNodeRpcClient\", function() { return CreateNodeRpcClient; });/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\tfunction CreateNodeRpcClient(url, options){\n\t\tvar httpOpt = options && options.http || {};\n\t\tvar httpLayer = new __WEBPACK_IMPORTED_MODULE_6__RequestLayer__[\"a\" /* default */](url, httpOpt.pre_request, httpOpt.post_request);\n\t\tvar jsonLayer = new __WEBPACK_IMPORTED_MODULE_2__JsonLayer__[\"a\" /* default */](httpLayer);\n\t\tvar protocolLayer = new __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__[\"a\" /* default */](jsonLayer);\n\t\tvar lo = options && options.log || {};\n\t\tvar logLayer = new __WEBPACK_IMPORTED_MODULE_1__LogLayer__[\"a\" /* default */](protocolLayer, lo.request, lo.response, lo.error);\n\t\treturn new __WEBPACK_IMPORTED_MODULE_5__RpcClient__[\"a\" /* default */](logLayer);\n\t}\n\t\n\tfunction CreateBrowserRpcClient(url, options){\n\t\tvar httpOpt = options && options.http || {};\n\t\tvar httpLayer = new __WEBPACK_IMPORTED_MODULE_0__AjaxLayer__[\"a\" /* default */](url, httpOpt.pre_request, httpOpt.post_request);\n\t\tvar jsonLayer = new __WEBPACK_IMPORTED_MODULE_2__JsonLayer__[\"a\" /* default */](httpLayer);\n\t\tvar protocolLayer = new __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__[\"a\" /* default */](jsonLayer);\n\t\tvar lo = options && options.log || {};\n\t\tvar logLayer = new __WEBPACK_IMPORTED_MODULE_1__LogLayer__[\"a\" /* default */](protocolLayer, lo.request, lo.response, lo.error);\n\t\treturn new __WEBPACK_IMPORTED_MODULE_5__RpcClient__[\"a\" /* default */](logLayer);\n\t}\n\t\n\t\n\t/* harmony reexport */ if(__webpack_require__.o(__WEBPACK_IMPORTED_MODULE_0__AjaxLayer__, \"a\")) __webpack_require__.d(exports, \"AjaxLayer\", function() { return __WEBPACK_IMPORTED_MODULE_0__AjaxLayer__[\"a\"]; });\n\t/* harmony reexport */ if(__webpack_require__.o(__WEBPACK_IMPORTED_MODULE_1__LogLayer__, \"a\")) __webpack_require__.d(exports, \"LogLayer\", function() { return __WEBPACK_IMPORTED_MODULE_1__LogLayer__[\"a\"]; });\n\t/* harmony reexport */ if(__webpack_require__.o(__WEBPACK_IMPORTED_MODULE_3__HookLayer__, \"a\")) __webpack_require__.d(exports, \"HookLayer\", function() { return __WEBPACK_IMPORTED_MODULE_3__HookLayer__[\"a\"]; });\n\t/* harmony reexport */ if(__webpack_require__.o(__WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__, \"a\")) __webpack_require__.d(exports, \"ProtocolLayer\", function() { return __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__[\"a\"]; });\n\t/* harmony reexport */ if(__webpack_require__.o(__WEBPACK_IMPORTED_MODULE_5__RpcClient__, \"a\")) __webpack_require__.d(exports, \"RpcClient\", function() { return __WEBPACK_IMPORTED_MODULE_5__RpcClient__[\"a\"]; });\n\t/* harmony reexport */ if(__webpack_require__.o(__WEBPACK_IMPORTED_MODULE_6__RequestLayer__, \"a\")) __webpack_require__.d(exports, \"RequestLayer\", function() { return __WEBPACK_IMPORTED_MODULE_6__RequestLayer__[\"a\"]; });\n\t/* harmony reexport */ if(__webpack_require__.o(__WEBPACK_IMPORTED_MODULE_2__JsonLayer__, \"a\")) __webpack_require__.d(exports, \"JsonLayer\", function() { return __WEBPACK_IMPORTED_MODULE_2__JsonLayer__[\"a\"]; });\n\t\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_9__;\n\n/***/ }\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// rpc_client.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3c316361b19bcdcf5128","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n * @param {string} url RPC-server URL\n * @param {function} pre_request_fn hook fn(xhr)\n * @param {function} post_request_fn hook fn(xhr)\n * @constructor\n */\n\nfunction AjaxLayer(url, pre_request_fn, post_request_fn){\n\n\tthis.send = function(request_str){\n\n\t\treturn new Promise(function(resolve, reject){\n\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\txhr.open(\"POST\", url, true);\n\t\t\txhr.withCredentials = true;\n\t\t\tpre_request_fn && pre_request_fn(xhr);\n\n\t\t\txhr.onload = function(){\n\t\t\t\tpost_request_fn && post_request_fn(xhr, true);\n\t\t\t\tif(this.status >= 200 && this.status < 300){\n\t\t\t\t\tresolve(xhr.response);\n\t\t\t\t}else{\n\t\t\t\t\treject({\n\t\t\t\t\t\tstatus: this.status,\n\t\t\t\t\t\tstatusText: xhr.statusText\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onerror = function(){\n\t\t\t\tpost_request_fn && post_request_fn(xhr, false);\n\t\t\t\treject({\n\t\t\t\t\tstatus: this.status,\n\t\t\t\t\tstatusText: xhr.statusText\n\t\t\t\t});\n\t\t\t};\n\n\t\t\txhr.send(request_str);\n\t\t});\n\n\t}\n}\n\nexport default AjaxLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/AjaxLayer.js\n// module id = 0\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n * @param protocol_layer\n * @param {function} pre_fn\n * @param {function} post_fn\n * @constructor\n */\nfunction HookLayer(protocol_layer, pre_fn, post_fn){\n\tthis.send = function(calls){\n\t\tcalls = pre_fn ? pre_fn(calls) : calls;\n\t\tvar promises = protocol_layer.send(calls);\n\t\treturn post_fn ? post_fn(promises) : promises;\n\t}\n}\n\nexport default HookLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/HookLayer.js\n// module id = 1\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n * @param {object} text_transport_layer\n * @constructor\n */\nfunction JsonLayer(text_transport_layer){\n\n\tthis.send = function(request){\n\n\t\treturn new Promise(function(resolve, reject){\n\t\t\ttry{\n\t\t\t\tvar json = JSON.stringify(request);\n\n\t\t\t\ttext_transport_layer.send(json).then(function(json_response){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tvar response = JSON.parse(json_response);\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\treject({\n\t\t\t\t\t\t\tname: \"JsonLayerError\",\n\t\t\t\t\t\t\tmessage: e.name + \": \" + e.message + \"\\n\" + json_response,\n\t\t\t\t\t\t\tcode: 1\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tresolve(response);\n\t\t\t\t}, reject);\n\t\t\t}catch(e){\n\t\t\t\treject({\n\t\t\t\t\tname: \"JsonLayerError\",\n\t\t\t\t\tmessage: e.name + \": \" + e.message,\n\t\t\t\t\tcode: 1\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport default JsonLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/JsonLayer.js\n// module id = 2\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n * @param {object} protocol_layer\n * @param {function} log_request_fn\n * @param {function} log_response_fn\n * @param {function} log_error_fn\n * @constructor\n */\nfunction LogLayer(protocol_layer, log_request_fn, log_response_fn, log_error_fn){\n\n\tthis.send = function(calls){\n\n\t\tvar i, call;\n\t\tif(log_request_fn){\n\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\tcall = calls[i];\n\t\t\t\tlog_request_fn(\"call[\" + i + \"]\", call[0] + '->' + call[1] + '(' + (call[2] && call[2].join(', ') || '') + ')');\n\t\t\t}\n\t\t}\n\n\t\tvar promises = protocol_layer.send(calls);\n\n\t\tif(log_response_fn || log_error_fn){\n\t\t\tfor(i = 0; i < promises.length; i++){\n\t\t\t\t(function(i){\n\t\t\t\t\tpromises[i].then(function(response){\n\t\t\t\t\t\tlog_response_fn && log_response_fn(\"result[\" + i + \"]\", response);\n\t\t\t\t\t\treturn response;\n\t\t\t\t\t}, function(error){\n\t\t\t\t\t\tvar logger = log_error_fn || log_response_fn;\n\t\t\t\t\t\tlogger && logger(\"error[\" + i + \"]\", error);\n\t\t\t\t\t})\n\t\t\t\t})(i);\n\t\t\t}\n\t\t}\n\t\treturn promises;\n\t}\n}\n\nexport  default LogLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/LogLayer.js\n// module id = 3\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\nfunction extractResult(response){\n\tif(typeof response !== \"object\"){\n\t\tthrow {name: \"RpcProtocolError\", message: \"Bad response format: object expected, got \" + (typeof response), code: 1};\n\t}\n\tif(response[\"status\"] === undefined){\n\t\tthrow {name: \"RpcProtocolError\", message: \"no status\", code: 1};\n\t}\n\tif(response[\"result\"] === undefined){\n\t\tthrow {name: \"RpcProtocolError\", message: \"no result\", code: 1};\n\t}\n\tif(!response[\"status\"]){\n\t\tthrow {name: response[\"result\"][\"type\"] || \"UnknownError\", message: response[\"result\"][\"message\"] || \"\", code: response[\"result\"][\"code\"] || 0};\n\t}\n\treturn response[\"result\"];\n}\n\n/**\n * @param {object} json_layer\n * @constructor\n */\nfunction ProtocolLayer(json_layer){\n\n\tvar id = 1;\n\n\tthis.send = function(calls){\n\n\t\tvar i, call;\n\t\tvar promises = new Array(calls.length);\n\t\tvar callbacks = [];\n\t\tif(calls.length > 0){\n\n\t\t\tvar formed_calls = new Array(calls.length);\n\n\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\tcall = calls[i];\n\t\t\t\tformed_calls[i] = {\n\t\t\t\t\tservice: call[0],\n\t\t\t\t\tmethod: call[1]\n\t\t\t\t};\n\t\t\t\tif(call[2] && call[2].length > 0){\n\t\t\t\t\tformed_calls[i].parameters = call[2];\n\t\t\t\t}\n\t\t\t\tpromises[i] = new Promise(function(resolve, reject){\n\t\t\t\t\tcallbacks.push([resolve, reject]);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar request = {\n\t\t\t\tid: id++,\n\t\t\t\tcalls: formed_calls\n\t\t\t};\n\n\t\t\tjson_layer.send(request).then(function(response){\n\t\t\t\ttry{\n\t\t\t\t\tvar result = extractResult(response);\n\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tvar r = extractResult(result[i]);\n\t\t\t\t\t\t\tcallbacks[i][0](r);\n\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}catch(e){\n\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, function(e){\n\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn promises;\n\t}\n\n}\n\nexport default ProtocolLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/ProtocolLayer.js\n// module id = 4\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\nimport request from 'request';\n\n/**\n* @param {string} url RPC-server URL\n* @param {?object} options for 'request' lib\n* @param {?function} pre_request_fn hook fn(requestOptions)\n* @param {?function} post_request_fn hook fn(response, successful)\n* @constructor\n*/\nfunction RequestLayer(url, pre_request_fn, post_request_fn){\n\n\tthis.send = function(request_str){\n\n\t\treturn new Promise(function(resolve, reject){\n\n\t\t\tvar requestOptions = {\n\t\t\t\tmethod: 'POST',\n\t\t\t\turi: url,\n\t\t\t\tbody: request_str,\n\t\t\t\tjar: true\n\t\t\t};\n\n\t\t\tpre_request_fn && pre_request_fn(requestOptions);\n\n\t\t\trequest(requestOptions, function(error, response, body){\n\t\t\t\t\tvar status = response.statusCode;\n\t\t\t\t\tif(!error && status >= 200 && status < 300){\n\t\t\t\t\t\tpost_request_fn && post_request_fn(response, true);\n\t\t\t\t\t\tresolve(body);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tpost_request_fn && post_request_fn(response, false);\n\t\t\t\t\t\treject({\n\t\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\t\terror: error\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t});\n\n\t}\n}\n\nexport default RequestLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/RequestLayer.js\n// module id = 5\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\nimport BatchLayer from \"./BatchLayer\";\n\n/**\n * @param {object} protocol_layer\n * @constructor\n */\nfunction RpcClient(protocol_layer){\n\n\tvar client = this;\n\n\tclient.call = function(service, method, params){\n\t\treturn protocol_layer.send([[service, method, params]])[0];\n\t};\n\n\tclient.batch = function(callback){\n\t\tvar batchLayer = new BatchLayer();\n\t\tvar batchClient = new RpcClient(batchLayer);\n\t\tcallback(batchClient);\n\t\treturn batchLayer.flush(protocol_layer);\n\t};\n\n}\n\nexport default RpcClient;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/RpcClient.js\n// module id = 6\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n * @constructor\n */\nfunction BatchLayer(){\n\n\tvar layer = this;\n\tvar i, calls_acc = [], callbacks_acc = [];\n\n\tlayer.send = function(calls){\n\t\tvar promises = new Array(calls.length);\n\t\tcalls_acc = calls_acc.concat(calls);\n\t\tfor(i = 0; i < calls.length; i++){\n\t\t\tpromises[i] = new Promise(function(resolve, reject){\n\t\t\t\tcallbacks_acc.push([resolve, reject]);\n\t\t\t});\n\t\t}\n\t\treturn promises;\n\t};\n\n\tlayer.flush = function(protocol_layer){\n\t\tvar promises = protocol_layer.send(calls_acc);\n\t\tfor(var i = 0; i < callbacks_acc.length; i++){\n\t\t\tpromises[i].then(callbacks_acc[i][0], callbacks_acc[i][1]);\n\t\t}\n\t\treturn promises;\n\t};\n\n}\n\nexport default BatchLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/BatchLayer.js\n// module id = 7\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\nimport AjaxLayer from \"./AjaxLayer\";\nimport LogLayer from \"./LogLayer\";\nimport JsonLayer from \"./JsonLayer\";\nimport HookLayer from \"./HookLayer\";\nimport ProtocolLayer from \"./ProtocolLayer\";\nimport RpcClient from \"./RpcClient\";\nimport RequestLayer from \"./RequestLayer\";\n\nfunction CreateNodeRpcClient(url, options){\n\tvar httpOpt = options && options.http || {};\n\tvar httpLayer = new RequestLayer(url, httpOpt.pre_request, httpOpt.post_request);\n\tvar jsonLayer = new JsonLayer(httpLayer);\n\tvar protocolLayer = new ProtocolLayer(jsonLayer);\n\tvar lo = options && options.log || {};\n\tvar logLayer = new LogLayer(protocolLayer, lo.request, lo.response, lo.error);\n\treturn new RpcClient(logLayer);\n}\n\nfunction CreateBrowserRpcClient(url, options){\n\tvar httpOpt = options && options.http || {};\n\tvar httpLayer = new AjaxLayer(url, httpOpt.pre_request, httpOpt.post_request);\n\tvar jsonLayer = new JsonLayer(httpLayer);\n\tvar protocolLayer = new ProtocolLayer(jsonLayer);\n\tvar lo = options && options.log || {};\n\tvar logLayer = new LogLayer(protocolLayer, lo.request, lo.response, lo.error);\n\treturn new RpcClient(logLayer);\n}\n\n\nexport {AjaxLayer, LogLayer, JsonLayer, HookLayer, ProtocolLayer, RpcClient, RequestLayer,\n\tCreateNodeRpcClient, CreateBrowserRpcClient};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.js\n// module id = 8\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_9__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request\"\n// module id = 9\n// module chunks = 0"],"sourceRoot":""}