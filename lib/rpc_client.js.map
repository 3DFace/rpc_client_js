{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 7276a1271b7052b5c2f7","webpack:///./src/HookLayer.js","webpack:///./src/JsonLayer.js","webpack:///./src/LogLayer.js","webpack:///./src/ProtocolLayer.js","webpack:///./src/RpcClient.js","webpack:///./src/AjaxLayer.js","webpack:///./src/CreateNodeRpcClient.js","webpack:///./src/RequestLayer.js","webpack:///./src/ApiGenerator.js","webpack:///./src/CreateBrowserRpcClient.js","webpack:///./src/BatchLayer.js","webpack:///./src/index.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA,YAAI;AACJ;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;ACrDA;;AAEA;AACA;AACA,YAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;ACbA;;AAEA;AACA,YAAW,OAAO;AAClB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,IAAG;AACH;AACA;;AAEA;;;;;;;;ACrCA;;AAEA;AACA,YAAW,OAAO;AAClB,YAAW,SAAS;AACpB,YAAW,SAAS;AACpB,YAAW,SAAS;AACpB;AACA;AACA;;AAEA;;AAEA;AACA;AACA,cAAa,kBAAkB;AAC/B;AACA;AACA;AACA;;AAEA;;AAEA;AACA,cAAa,qBAAqB;AAClC;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;ACxCA;;AAEA;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA,YAAW,OAAO;AAClB;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,cAAa,kBAAkB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAe,sBAAsB;AACrC;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;AACL,gBAAe,sBAAsB;AACrC;AACA;AACA;AACA,KAAI;AACJ,eAAc,sBAAsB;AACpC;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;;AAEA;;;;;;;;ACjFA;AAAA;;AAEA;;AAEA;AACA,YAAW,OAAO;AAClB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;AACH;;AAEA;;AAEA;;;;;;;;AClCA;;AAEA;AACA,YAAW,OAAO;AAClB,YAAW,SAAS;AACpB,YAAW,SAAS;AACpB;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA,IAAG;;AAEH;AACA;;AAEA;;;;;;;;;;;;;AC7CA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;ACnBA;;AAEA;AACA,WAAU,OAAO;AACjB,WAAU,SAAS;AACnB;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,QAAO;AACP;AACA,MAAK;AACL,IAAG;;AAEH;AACA;;AAEA;;;;;;;;ACpCA;AAAA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,4HAAkD,MAAM,0BAA0B;;AAElF;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA,qFAAoF;AACpF,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL,KAAI;AACJ,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,wDAAuD;AACvD,2DAA0D;AAC1D;AACA;AACA;AACA;AACA,sCAAqC,QAAQ;AAC7C;AACA,8EAA6E;AAC7E,wFAAuF;AACvF,4BAA2B;AAC3B,IAAG;AACH,wBAAuB;AACvB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA,8EAA6E;AAC7E,IAAG;AACH,wBAAuB;AACvB;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;;AAEA;;;;;;;;;;;;;AC3GA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;ACpBA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAY,kBAAkB;AAC9B;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA,iBAAgB,0BAA0B;AAC1C;AACA;AACA;AACA;;AAEA;;AAEA;;;;;;;;;;;;;;;;;AC/BA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AAIA","file":"rpc_client.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"rpc_client\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"rpc_client\"] = factory();\n\telse\n\t\troot[\"rpc_client\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7276a1271b7052b5c2f7","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n * @param protocol_layer\n * @param {function} layer_fn\n * @constructor\n */\nfunction HookLayer(protocol_layer, layer_fn){\n\tthis.send = function(calls){\n\t\treturn layer_fn(calls, protocol_layer);\n\t}\n}\n\nexport default HookLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/HookLayer.js\n// module id = 0\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n * @param {object} text_transport_layer\n * @constructor\n */\nfunction JsonLayer(text_transport_layer){\n\n\tthis.send = function(request){\n\n\t\treturn new Promise(function(resolve, reject){\n\t\t\ttry{\n\t\t\t\tvar json = JSON.stringify(request);\n\n\t\t\t\ttext_transport_layer.send(json).then(function(json_response){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tvar response = JSON.parse(json_response);\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\treject({\n\t\t\t\t\t\t\tname: \"JsonLayerError\",\n\t\t\t\t\t\t\tmessage: e.name + \": \" + e.message + \"\\n\" + json_response,\n\t\t\t\t\t\t\tcode: 1\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tresolve(response);\n\t\t\t\t}, reject);\n\t\t\t}catch(e){\n\t\t\t\treject({\n\t\t\t\t\tname: \"JsonLayerError\",\n\t\t\t\t\tmessage: e.name + \": \" + e.message,\n\t\t\t\t\tcode: 1\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport default JsonLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/JsonLayer.js\n// module id = 1\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n * @param {object} protocol_layer\n * @param {function} log_request_fn\n * @param {function} log_response_fn\n * @param {function} log_error_fn\n * @constructor\n */\nfunction LogLayer(protocol_layer, log_request_fn, log_response_fn, log_error_fn){\n\n\tthis.send = function(calls){\n\n\t\tvar i, call;\n\t\tif(log_request_fn){\n\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\tcall = calls[i];\n\t\t\t\tlog_request_fn(\"call[\" + i + \"]\", call[0] + '->' + call[1] + '(' + (call[2] && call[2].join(', ') || '') + ')');\n\t\t\t}\n\t\t}\n\n\t\tvar promises = protocol_layer.send(calls);\n\n\t\tif(log_response_fn || log_error_fn){\n\t\t\tfor(i = 0; i < promises.length; i++){\n\t\t\t\t(function(i){\n\t\t\t\t\tpromises[i].then(function(response){\n\t\t\t\t\t\tlog_response_fn && log_response_fn(\"result[\" + i + \"]\", response);\n\t\t\t\t\t\treturn response;\n\t\t\t\t\t}, function(error){\n\t\t\t\t\t\tvar logger = log_error_fn || log_response_fn;\n\t\t\t\t\t\tlogger && logger(\"error[\" + i + \"]\", error);\n\t\t\t\t\t})\n\t\t\t\t})(i);\n\t\t\t}\n\t\t}\n\t\treturn promises;\n\t}\n}\n\nexport  default LogLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/LogLayer.js\n// module id = 2\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\nfunction extractResult(response){\n\tif(typeof response !== \"object\"){\n\t\tthrow {name: \"RpcProtocolError\", message: \"Bad response format: object expected, got \" + (typeof response), code: 1};\n\t}\n\tif(response[\"status\"] === undefined){\n\t\tthrow {name: \"RpcProtocolError\", message: \"no status\", code: 1};\n\t}\n\tif(response[\"result\"] === undefined){\n\t\tthrow {name: \"RpcProtocolError\", message: \"no result\", code: 1};\n\t}\n\tif(!response[\"status\"]){\n\t\tthrow {name: response[\"result\"][\"type\"] || \"UnknownError\", message: response[\"result\"][\"message\"] || \"\", code: response[\"result\"][\"code\"] || 0};\n\t}\n\treturn response[\"result\"];\n}\n\n/**\n * @param {object} json_layer\n * @constructor\n */\nfunction ProtocolLayer(json_layer){\n\n\tvar id = 1;\n\n\tthis.send = function(calls){\n\n\t\tvar i, call;\n\t\tvar promises = new Array(calls.length);\n\t\tvar callbacks = [];\n\t\tif(calls.length > 0){\n\n\t\t\tvar formed_calls = new Array(calls.length);\n\n\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\tcall = calls[i];\n\t\t\t\tformed_calls[i] = {\n\t\t\t\t\tservice: call[0],\n\t\t\t\t\tmethod: call[1]\n\t\t\t\t};\n\t\t\t\tif(call[2] && call[2].length > 0){\n\t\t\t\t\tformed_calls[i].parameters = call[2];\n\t\t\t\t}\n\t\t\t\tpromises[i] = new Promise(function(resolve, reject){\n\t\t\t\t\tcallbacks.push([resolve, reject]);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar request = {\n\t\t\t\tid: id++,\n\t\t\t\tcalls: formed_calls\n\t\t\t};\n\n\t\t\tjson_layer.send(request).then(function(response){\n\t\t\t\ttry{\n\t\t\t\t\tvar result = extractResult(response);\n\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tvar r = extractResult(result[i]);\n\t\t\t\t\t\t\tcallbacks[i][0](r);\n\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}catch(e){\n\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, function(e){\n\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn promises;\n\t}\n\n}\n\nexport default ProtocolLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/ProtocolLayer.js\n// module id = 3\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\nimport BatchLayer from \"./BatchLayer\";\n\n/**\n * @param {object} protocol_layer\n * @constructor\n */\nfunction RpcClient(protocol_layer){\n\n\tvar client = this;\n\n\tclient.call = function(service, method, params){\n\t\treturn protocol_layer.send([[service, method, params]])[0];\n\t};\n\n\tclient.batch = function(callback){\n\t\tvar batchLayer = new BatchLayer();\n\t\tvar batchClient = new RpcClient(batchLayer);\n\t\tcallback(batchClient);\n\t\tvar promises = batchLayer.flush(protocol_layer);\n\t\treturn new Promise(function(resolve){\n\t\t\tvar wait = promises.length;\n\t\t\tfunction done(){\n\t\t\t\t--wait || resolve();\n\t\t\t}\n\t\t\tpromises.forEach(function(p){\n\t\t\t\tp.then(done, done);\n\t\t\t});\n\t\t});\n\t};\n\n}\n\nexport default RpcClient;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/RpcClient.js\n// module id = 4\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n * @param {string} url RPC-server URL\n * @param {function} pre_request_fn hook fn(xhr)\n * @param {function} post_request_fn hook fn(xhr)\n * @constructor\n */\n\nfunction AjaxLayer(url, pre_request_fn, post_request_fn){\n\n\tthis.send = function(request_str){\n\n\t\treturn new Promise(function(resolve, reject){\n\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\txhr.open(\"POST\", url, true);\n\t\t\txhr.withCredentials = true;\n\t\t\tpre_request_fn && pre_request_fn(xhr);\n\n\t\t\txhr.onload = function(){\n\t\t\t\tpost_request_fn && post_request_fn(xhr, true);\n\t\t\t\tif(this.status >= 200 && this.status < 300){\n\t\t\t\t\tresolve(xhr.response);\n\t\t\t\t}else{\n\t\t\t\t\treject({\n\t\t\t\t\t\tstatus: this.status,\n\t\t\t\t\t\tstatusText: xhr.statusText\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onerror = function(){\n\t\t\t\tpost_request_fn && post_request_fn(xhr, false);\n\t\t\t\treject({\n\t\t\t\t\tstatus: this.status,\n\t\t\t\t\tstatusText: xhr.statusText\n\t\t\t\t});\n\t\t\t};\n\n\t\t\txhr.send(request_str);\n\t\t});\n\n\t}\n}\n\nexport default AjaxLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/AjaxLayer.js\n// module id = 5\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\nimport LogLayer from \"./LogLayer\";\nimport JsonLayer from \"./JsonLayer\";\nimport ProtocolLayer from \"./ProtocolLayer\";\nimport RpcClient from \"./RpcClient\";\nimport HookLayer from \"./HookLayer\";\nimport RequestLayer from \"./RequestLayer\";\n\nfunction CreateNodeRpcClient(url, request_fn, options){\n\tvar httpLayer = new RequestLayer(url, request_fn);\n\tvar jsonLayer = new JsonLayer(httpLayer);\n\tvar protocolLayer = new ProtocolLayer(jsonLayer);\n\tvar lo = options && options.log || {};\n\tvar logLayer = new LogLayer(protocolLayer, lo.request, lo.response, lo.error);\n\tvar topLayer = options.hook ? new HookLayer(logLayer, options.hook) : logLayer;\n\treturn new RpcClient(topLayer);\n}\n\nexport default CreateNodeRpcClient;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/CreateNodeRpcClient.js\n// module id = 6\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n* @param {string} url RPC-server URL\n* @param {function} request_fn 'request' library fn(requestOptions, callback)\n* @constructor\n*/\nfunction RequestLayer(url, request_fn){\n\n\tthis.send = function(request_str){\n\n\t\treturn new Promise(function(resolve, reject){\n\n\t\t\tvar requestOptions = {\n\t\t\t\tmethod: 'POST',\n\t\t\t\turi: url,\n\t\t\t\tbody: request_str,\n\t\t\t\tjar: true\n\t\t\t};\n\n\t\t\trequest_fn(requestOptions, function(error, response, body){\n\t\t\t\t\tvar status = response && response.statusCode;\n\t\t\t\t\tif(!error && status >= 200 && status < 300){\n\t\t\t\t\t\tresolve(body);\n\t\t\t\t\t}else{\n\t\t\t\t\t\treject({\n\t\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\t\terror: error\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t});\n\n\t}\n}\n\nexport default RequestLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/RequestLayer.js\n// module id = 7\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\nimport CreateNodeRpcClient from './CreateNodeRpcClient';\n\n/**\n * @constructor\n */\nfunction ApiGenerator(url, request_fn){\n\n\tvar log = console.log.bind(console);\n\tvar call = CreateNodeRpcClient(url, request_fn, {log: {request: log, error: log}}).call;\n\n\tthis.generate = function(className, path){\n\t\tvar rootContainer, serviceName;\n\t\tif(path){\n\t\t\tvar pathArr = path.split(\"/\");\n\t\t\tserviceName = pathArr.pop();\n\t\t\trootContainer = pathArr.join(\"/\");\n\t\t}else{\n\t\t\trootContainer = null;\n\t\t\tserviceName = null;\n\t\t}\n\t\treturn loadContainer(rootContainer).then(function(tree){\n\t\t\tvar service;\n\t\t\tif(serviceName){\n\t\t\t\tservice = tree.items.find(function(i){\n\t\t\t\t\treturn i.name == serviceName;\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tservice = tree;\n\t\t\t}\n\t\t\tvar classDef = generateSomething(className, service, \"\", path);\n\t\t\treturn \"// GENERATED CODE\\n\\n\" + classDef + \"\\nexport default \"  + className + \";\\n\";\n\t\t}, log);\n\t};\n\n\tfunction loadContainer(pathName){\n\t\treturn new Promise(function(resolve, reject){\n\t\t\tcall(\"explorer\", \"getServicesInfo\", [pathName]).then(function(items){\n\t\t\t\tvar subPromises = [];\n\t\t\t\titems.forEach(function(i){\n\t\t\t\t\tif(i.container){\n\t\t\t\t\t\tvar iName = pathName ? pathName + '/' + e.name : i.name;\n\t\t\t\t\t\tsubPromises.push(loadContainer(iName));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tsubPromises.push(i);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tPromise.all(subPromises).then(function(items){\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tname: pathName,\n\t\t\t\t\t\tcontainer: true,\n\t\t\t\t\t\titems: items\n\t\t\t\t\t});\n\t\t\t\t}, reject);\n\t\t\t});\n\t\t})\n\t}\n\n\tfunction generateServiceClass(className, serviceDef, indent, iPath){\n\t\tvar result = \"\";\n\t\tresult += indent + \"/**\\n\";\n\t\tresult += indent + \" * @constructor\\n\";\n\t\tresult += indent + \" */\\n\";\n\t\tresult += indent + \"function \" + className + \"(call){\\n\\n\";\n\t\tresult += indent + \"\\tvar servicePath = '\" + iPath + \"';\\n\";\n\t\tserviceDef.methods.forEach(function(m){\n\t\t\tresult += \"\\n\";\n\t\t\tvar params = m.params.join(\", \");\n\t\t\tresult += indent + \"\\t/**\\n\";\n\t\t\tresult += indent + \"\\t * @return {Promise}\\n\";\n\t\t\tresult += indent + \"\\t */\\n\";\n\t\t\tresult += indent + \"\\tthis.\" + m.name + \" = \" + \"function(\" + params + \"){\\n\";\n\t\t\tresult += indent + \"\\t\\treturn call(servicePath, '\" + m.name + \"', [\" + params +\"]);\\n\";\n\t\t\tresult += indent + \"\\t};\\n\";\n\t\t});\n\t\tresult += indent + \"}\\n\";\n\t\treturn result;\n\t}\n\n\tfunction generateContainerClass(className, tree, indent, path){\n\t\tvar result = \"\";\n\t\tresult += indent + \"/**\\n\";\n\t\tresult += indent + \" * @constructor\\n\";\n\t\tresult += indent + \" */\\n\";\n\t\tresult += indent + \"function \" + className + \"(call){\\n\";\n\t\ttree.items.forEach(function(i){\n\t\t\tvar iClass = i.name[0].toUpperCase() + i.name.substr(1);\n\t\t\tvar iVar = i.name;\n\t\t\tvar iPath = path ? path + '/' + i.name : i.name;\n\t\t\tresult += \"\\n\" + generateSomething(iClass, i, indent + \"\\t\", iPath);\n\t\t\tresult += \"\\n\" + indent + \"\\tthis.\" + iVar + \" = new \" + iClass + \"(call);\\n\";\n\t\t});\n\t\tresult += indent + \"}\\n\";\n\t\treturn result;\n\t}\n\n\tfunction generateSomething(className, definition, indent, iPath){\n\t\tif(definition.container){\n\t\t\treturn generateContainerClass(className, definition, indent, iPath);\n\t\t}else{\n\t\t\treturn generateServiceClass(className, definition, indent, iPath);\n\t\t}\n\t}\n\t\n}\n\nexport default ApiGenerator;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/ApiGenerator.js\n// module id = 8\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\nimport AjaxLayer from \"./AjaxLayer\";\nimport LogLayer from \"./LogLayer\";\nimport JsonLayer from \"./JsonLayer\";\nimport ProtocolLayer from \"./ProtocolLayer\";\nimport HookLayer from \"./HookLayer\";\nimport RpcClient from \"./RpcClient\";\n\nfunction CreateBrowserRpcClient(url, options){\n\tvar httpOpt = options && options.http || {};\n\tvar httpLayer = new AjaxLayer(url, httpOpt.pre_request, httpOpt.post_request);\n\tvar jsonLayer = new JsonLayer(httpLayer);\n\tvar protocolLayer = new ProtocolLayer(jsonLayer);\n\tvar lo = options && options.log || {};\n\tvar logLayer = new LogLayer(protocolLayer, lo.request, lo.response, lo.error);\n\tvar topLayer = options.hook ? new HookLayer(logLayer, options.hook) : logLayer;\n\treturn new RpcClient(topLayer);\n}\n\nexport default CreateBrowserRpcClient;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/CreateBrowserRpcClient.js\n// module id = 9\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\n/**\n * @constructor\n */\nfunction BatchLayer(){\n\n\tvar layer = this;\n\tvar i, calls_acc = [], callbacks_acc = [];\n\n\tlayer.send = function(calls){\n\t\tvar promises = new Array(calls.length);\n\t\tcalls_acc = calls_acc.concat(calls);\n\t\tfor(i = 0; i < calls.length; i++){\n\t\t\tpromises[i] = new Promise(function(resolve, reject){\n\t\t\t\tcallbacks_acc.push([resolve, reject]);\n\t\t\t});\n\t\t}\n\t\treturn promises;\n\t};\n\n\tlayer.flush = function(protocol_layer){\n\t\tvar promises = protocol_layer.send(calls_acc);\n\t\tfor(var i = 0; i < callbacks_acc.length; i++){\n\t\t\tpromises[i].then(callbacks_acc[i][0], callbacks_acc[i][1]);\n\t\t}\n\t\treturn promises;\n\t};\n\n}\n\nexport default BatchLayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/BatchLayer.js\n// module id = 10\n// module chunks = 0","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\nimport AjaxLayer from \"./AjaxLayer\";\nimport LogLayer from \"./LogLayer\";\nimport JsonLayer from \"./JsonLayer\";\nimport HookLayer from \"./HookLayer\";\nimport ProtocolLayer from \"./ProtocolLayer\";\nimport RpcClient from \"./RpcClient\";\nimport RequestLayer from \"./RequestLayer\";\nimport CreateNodeRpcClient from './CreateNodeRpcClient';\nimport CreateBrowserRpcClient from './CreateBrowserRpcClient';\nimport ApiGenerator from './ApiGenerator';\n\nexport {AjaxLayer, LogLayer, JsonLayer, HookLayer, ProtocolLayer, RpcClient, RequestLayer,\n\tCreateNodeRpcClient, CreateBrowserRpcClient,\n\tApiGenerator};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.js\n// module id = 11\n// module chunks = 0"],"sourceRoot":""}