{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///rpc_client.js","webpack:///webpack/bootstrap a185735cfd8df0929ddf","webpack:///external \"promise\"","webpack:///./src/AjaxLayer.js","webpack:///./src/HookLayer.js","webpack:///./src/JsonLayer.js","webpack:///./src/LogLayer.js","webpack:///./src/ProtocolLayer.js","webpack:///./src/RpcClient.js","webpack:///./src/BatchLayer.js","webpack:///./src/index.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_0__","modules","__webpack_require__","moduleId","installedModules","e","i","l","call","m","c","p","s","__WEBPACK_AMD_DEFINE_RESULT__","AjaxLayer","url","send","request","Promise","resolve","reject","xhr","XMLHttpRequest","open","withCredentials","onload","status","response","statusText","onerror","undefined","HookLayer","protocol_layer","pre_fn","post_fn","calls","promises","JsonLayer","under_layer","json","JSON","stringify","then","json_response","parse","name","message","LogLayer","log_request_fn","log_response_fn","log_error_fn","length","join","new_promises","Array","error","logger","extractResult","ProtocolLayer","id","callbacks","formed_calls","service","method","parameters","push","result","r","RpcClient","client","params","batch","callback","batchLayer","BatchLayer","batchClient","flush","layer","calls_acc","callbacks_acc","concat","__WEBPACK_IMPORTED_MODULE_0__AjaxLayer__","__WEBPACK_IMPORTED_MODULE_0__AjaxLayer___default","__esModule","Object","defineProperty","get","__WEBPACK_IMPORTED_MODULE_1__LogLayer__","__WEBPACK_IMPORTED_MODULE_1__LogLayer___default","__WEBPACK_IMPORTED_MODULE_2__JsonLayer__","__WEBPACK_IMPORTED_MODULE_2__JsonLayer___default","__WEBPACK_IMPORTED_MODULE_3__HookLayer__","__WEBPACK_IMPORTED_MODULE_3__HookLayer___default","__WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__","__WEBPACK_IMPORTED_MODULE_4__ProtocolLayer___default","__WEBPACK_IMPORTED_MODULE_5__RpcClient__","__WEBPACK_IMPORTED_MODULE_5__RpcClient___default","configurable","enumerable","a"],"mappings":"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","file":"rpc_client.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"promise\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"rpc_client\", [\"promise\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"rpc_client\"] = factory(require(\"promise\"));\n\telse\n\t\troot[\"rpc_client\"] = factory(root[\"promise\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"promise\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"rpc_client\", [\"promise\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"rpc_client\"] = factory(require(\"promise\"));\n\telse\n\t\troot[\"rpc_client\"] = factory(root[\"promise\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].e;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\te: {},\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.e, module, module.e, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.e;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 8);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\tmodule.e = __WEBPACK_EXTERNAL_MODULE_0__;\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_RESULT__;/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t!(__WEBPACK_AMD_DEFINE_RESULT__ = function(require){\n\t\n\t\tvar Promise = __webpack_require__(0);\n\t\n\t\t/**\n\t\t * @param {string} url RPC-server URL\n\t\t * @constructor\n\t\t */\n\t\tfunction AjaxLayer(url){\n\t\n\t\t\tthis.send = function(request){\n\t\n\t\t\t\treturn new Promise(function(resolve, reject){\n\t\t\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\t\t\txhr.open(\"POST\", url, true);\n\t\t\t\t\txhr.withCredentials = true;\n\t\n\t\t\t\t\txhr.onload = function(){\n\t\t\t\t\t\tif(this.status >= 200 && this.status < 300){\n\t\t\t\t\t\t\tresolve(xhr.response);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\treject({\n\t\t\t\t\t\t\t\tstatus: this.status,\n\t\t\t\t\t\t\t\tstatusText: xhr.statusText\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\n\t\t\t\t\txhr.onerror = function(){\n\t\t\t\t\t\treject({\n\t\t\t\t\t\t\tstatus: this.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText\n\t\t\t\t\t\t});\n\t\t\t\t\t};\n\t\n\t\t\t\t\txhr.send(request);\n\t\t\t\t});\n\t\n\t\t\t}\n\t\t}\n\t\n\t\treturn AjaxLayer;\n\t}.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.e = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_RESULT__;/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t!(__WEBPACK_AMD_DEFINE_RESULT__ = function(){\n\t\n\t\t/**\n\t\t * @param protocol_layer\n\t\t * @param {function} pre_fn\n\t\t * @param {function} post_fn\n\t\t * @constructor\n\t\t */\n\t\tfunction HookLayer(protocol_layer, pre_fn, post_fn){\n\t\t\tthis.send = function(calls){\n\t\t\t\tcalls = pre_fn ? pre_fn(calls) : calls;\n\t\t\t\tvar promises = protocol_layer.send(calls);\n\t\t\t\treturn post_fn ? post_fn(promises) : promises;\n\t\t\t}\n\t\t}\n\t\treturn HookLayer;\n\t\n\t}.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.e = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_RESULT__;/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t!(__WEBPACK_AMD_DEFINE_RESULT__ = function(require){\n\t\n\t\tvar Promise = __webpack_require__(0);\n\t\n\t\t/**\n\t\t *\n\t\t * @param {object} under_layer\n\t\t * @constructor\n\t\t */\n\t\tfunction JsonLayer(under_layer){\n\t\n\t\t\tthis.send = function(request){\n\t\n\t\t\t\treturn new Promise(function(resolve, reject){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tvar json = JSON.stringify(request);\n\t\n\t\t\t\t\t\tunder_layer.send(json).then(function(json_response){\n\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\tvar response = JSON.parse(json_response);\n\t\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\t\treject({\n\t\t\t\t\t\t\t\t\tname: \"JsonLayerError\",\n\t\t\t\t\t\t\t\t\tmessage: e.name + \": \" + e.message + \"\\n\" + json_response\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t\t}, reject);\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\treject({\n\t\t\t\t\t\t\tname: \"JsonLayerError\",\n\t\t\t\t\t\t\tmessage: e.name + \": \" + e.message\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\n\t\treturn JsonLayer;\n\t\n\t}.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.e = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_RESULT__;/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t!(__WEBPACK_AMD_DEFINE_RESULT__ = function(require){\n\t\n\t\t/**\n\t\t * @param {object} under_layer\n\t\t * @param {function} log_request_fn\n\t\t * @param {function} log_response_fn\n\t\t * @param {function} log_error_fn\n\t\t * @constructor\n\t\t */\n\t\tfunction LogLayer(under_layer, log_request_fn, log_response_fn, log_error_fn){\n\t\n\t\t\tthis.send = function(calls){\n\t\n\t\t\t\tvar i, call;\n\t\t\t\tif(log_request_fn){\n\t\t\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\t\t\tcall = calls[i];\n\t\t\t\t\t\tlog_request_fn(\"call[\" + i + \"]\", call[0] + '->' + call[1] + '(' + (call[2] && call[2].join(', ') || '') + ')');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tvar promises = under_layer.send(calls);\n\t\n\t\t\t\tif(log_response_fn || log_error_fn){\n\t\t\t\t\tvar new_promises = new Array(promises.length);\n\t\t\t\t\tfor(i = 0; i < promises.length; i++){\n\t\t\t\t\t\t(function(i){\n\t\t\t\t\t\t\tnew_promises[i] = promises[i].then(function(response){\n\t\t\t\t\t\t\t\tlog_response_fn && log_response_fn(\"result[\" + i + \"]\", response);\n\t\t\t\t\t\t\t\treturn response;\n\t\t\t\t\t\t\t}, function(error){\n\t\t\t\t\t\t\t\tvar logger = log_error_fn || log_response_fn;\n\t\t\t\t\t\t\t\tlogger && logger(\"error[\" + i + \"]\", error);\n\t\t\t\t\t\t\t\tthrow error;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t})(i);\n\t\t\t\t\t}\n\t\t\t\t\treturn new_promises;\n\t\t\t\t}else{\n\t\t\t\t\treturn promises;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\treturn LogLayer;\n\t\n\t}.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.e = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_RESULT__;/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t!(__WEBPACK_AMD_DEFINE_RESULT__ = function(require){\n\t\n\t\tvar Promise = __webpack_require__(0);\n\t\n\t\tfunction extractResult(response){\n\t\t\tif(typeof response !== \"object\"){\n\t\t\t\tthrow {name: \"RpcProtocolError\", message: \"Bad response format: object expected, got \" + (typeof response)};\n\t\t\t}\n\t\t\tif(response[\"status\"] === undefined){\n\t\t\t\tthrow {name: \"RpcProtocolError\", message: \"no status\"};\n\t\t\t}\n\t\t\tif(response[\"result\"] === undefined){\n\t\t\t\tthrow {name: \"RpcProtocolError\", message: \"no result\"};\n\t\t\t}\n\t\t\tif(!response[\"status\"]){\n\t\t\t\tthrow {name: response[\"result\"][\"type\"] || \"UnknownError\", message: response[\"result\"][\"message\"] || \"\"};\n\t\t\t}\n\t\t\treturn response[\"result\"];\n\t\t}\n\t\n\t\t/**\n\t\t * @param {object} under_layer\n\t\t * @constructor\n\t\t */\n\t\tfunction ProtocolLayer(under_layer){\n\t\n\t\t\tvar id = 1;\n\t\n\t\t\tthis.send = function(calls){\n\t\n\t\t\t\tvar i, call;\n\t\t\t\tvar promises = new Array(calls.length);\n\t\t\t\tvar callbacks = [];\n\t\t\t\tif(calls.length > 0){\n\t\n\t\t\t\t\tvar formed_calls = new Array(calls.length);\n\t\n\t\t\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\t\t\tcall = calls[i];\n\t\t\t\t\t\tformed_calls[i] = {\n\t\t\t\t\t\t\tservice: call[0],\n\t\t\t\t\t\t\tmethod: call[1]\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif(call[2] && call[2].length > 0){\n\t\t\t\t\t\t\tformed_calls[i].parameters = call[2];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpromises[i] = new Promise(function(resolve, reject){\n\t\t\t\t\t\t\tcallbacks.push([resolve, reject]);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\n\t\t\t\t\tvar request = {\n\t\t\t\t\t\tid: id++,\n\t\t\t\t\t\tcalls: formed_calls\n\t\t\t\t\t};\n\t\n\t\t\t\t\tunder_layer.send(request).then(function(response){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tvar result = extractResult(response);\n\t\t\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\t\tvar r = extractResult(result[i]);\n\t\t\t\t\t\t\t\t\tcallbacks[i][0](r);\n\t\t\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, function(e){\n\t\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn promises;\n\t\t\t}\n\t\n\t\t}\n\t\n\t\treturn ProtocolLayer;\n\t\n\t}.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.e = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_RESULT__;/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t!(__WEBPACK_AMD_DEFINE_RESULT__ = function(require){\n\t\n\t\tvar BatchLayer = __webpack_require__(7);\n\t\n\t\t/**\n\t\t * @param protocol_layer\n\t\t * @constructor\n\t\t */\n\t\tfunction RpcClient(protocol_layer){\n\t\n\t\t\tvar client = this;\n\t\n\t\t\tclient.call = function(service, method, params){\n\t\t\t\treturn protocol_layer.send([[service, method, params]])[0];\n\t\t\t};\n\t\n\t\t\tclient.batch = function(callback){\n\t\t\t\tvar batchLayer = new BatchLayer();\n\t\t\t\tvar batchClient = new RpcClient(batchLayer);\n\t\t\t\tcallback(batchClient);\n\t\t\t\treturn batchLayer.flush(protocol_layer);\n\t\t\t};\n\t\n\t\t}\n\t\n\t\treturn RpcClient;\n\t\n\t}.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.e = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_RESULT__;/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t!(__WEBPACK_AMD_DEFINE_RESULT__ = function(require){\n\t\n\t\tvar Promise = __webpack_require__(0);\n\t\n\t\t/**\n\t\t * @constructor\n\t\t */\n\t\tfunction BatchLayer(){\n\t\n\t\t\tvar layer = this;\n\t\t\tvar i, calls_acc = [], callbacks_acc = [];\n\t\n\t\t\tlayer.send = function(calls){\n\t\t\t\tvar promises = new Array(calls.length);\n\t\t\t\tcalls_acc = calls_acc.concat(calls);\n\t\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\t\tpromises[i] = new Promise(function(resolve, reject){\n\t\t\t\t\t\tcallbacks_acc.push([resolve, reject]);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn promises;\n\t\t\t};\n\t\n\t\t\tlayer.flush = function(protocol_layer){\n\t\t\t\tvar promises = protocol_layer.send(calls_acc);\n\t\t\t\tvar new_promises = new Array(promises.length);\n\t\t\t\tfor(var i = 0; i < callbacks_acc.length; i++){\n\t\t\t\t\tnew_promises[i] = promises[i].then(callbacks_acc[i][0], callbacks_acc[1]);\n\t\t\t\t}\n\t\t\t\treturn new_promises;\n\t\t\t};\n\t\n\t\t}\n\t\n\t\treturn BatchLayer;\n\t\n\t}.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.e = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__AjaxLayer__ = __webpack_require__(1);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__AjaxLayer___default = __WEBPACK_IMPORTED_MODULE_0__AjaxLayer__ && __WEBPACK_IMPORTED_MODULE_0__AjaxLayer__.__esModule ? function() { return __WEBPACK_IMPORTED_MODULE_0__AjaxLayer__['default'] } : function() { return __WEBPACK_IMPORTED_MODULE_0__AjaxLayer__; }\n\t/* harmony import */ Object.defineProperty(__WEBPACK_IMPORTED_MODULE_0__AjaxLayer___default, 'a', { get: __WEBPACK_IMPORTED_MODULE_0__AjaxLayer___default });\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__LogLayer__ = __webpack_require__(4);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__LogLayer___default = __WEBPACK_IMPORTED_MODULE_1__LogLayer__ && __WEBPACK_IMPORTED_MODULE_1__LogLayer__.__esModule ? function() { return __WEBPACK_IMPORTED_MODULE_1__LogLayer__['default'] } : function() { return __WEBPACK_IMPORTED_MODULE_1__LogLayer__; }\n\t/* harmony import */ Object.defineProperty(__WEBPACK_IMPORTED_MODULE_1__LogLayer___default, 'a', { get: __WEBPACK_IMPORTED_MODULE_1__LogLayer___default });\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__JsonLayer__ = __webpack_require__(3);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__JsonLayer___default = __WEBPACK_IMPORTED_MODULE_2__JsonLayer__ && __WEBPACK_IMPORTED_MODULE_2__JsonLayer__.__esModule ? function() { return __WEBPACK_IMPORTED_MODULE_2__JsonLayer__['default'] } : function() { return __WEBPACK_IMPORTED_MODULE_2__JsonLayer__; }\n\t/* harmony import */ Object.defineProperty(__WEBPACK_IMPORTED_MODULE_2__JsonLayer___default, 'a', { get: __WEBPACK_IMPORTED_MODULE_2__JsonLayer___default });\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__HookLayer__ = __webpack_require__(2);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__HookLayer___default = __WEBPACK_IMPORTED_MODULE_3__HookLayer__ && __WEBPACK_IMPORTED_MODULE_3__HookLayer__.__esModule ? function() { return __WEBPACK_IMPORTED_MODULE_3__HookLayer__['default'] } : function() { return __WEBPACK_IMPORTED_MODULE_3__HookLayer__; }\n\t/* harmony import */ Object.defineProperty(__WEBPACK_IMPORTED_MODULE_3__HookLayer___default, 'a', { get: __WEBPACK_IMPORTED_MODULE_3__HookLayer___default });\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__ = __webpack_require__(5);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer___default = __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__ && __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__.__esModule ? function() { return __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__['default'] } : function() { return __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer__; }\n\t/* harmony import */ Object.defineProperty(__WEBPACK_IMPORTED_MODULE_4__ProtocolLayer___default, 'a', { get: __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer___default });\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__RpcClient__ = __webpack_require__(6);\n\t/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__RpcClient___default = __WEBPACK_IMPORTED_MODULE_5__RpcClient__ && __WEBPACK_IMPORTED_MODULE_5__RpcClient__.__esModule ? function() { return __WEBPACK_IMPORTED_MODULE_5__RpcClient__['default'] } : function() { return __WEBPACK_IMPORTED_MODULE_5__RpcClient__; }\n\t/* harmony import */ Object.defineProperty(__WEBPACK_IMPORTED_MODULE_5__RpcClient___default, 'a', { get: __WEBPACK_IMPORTED_MODULE_5__RpcClient___default });\n\t/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\t\n\t\n\t\n\t\n\t\n\t\n\t/* harmony reexport */ Object.defineProperty(exports, \"RpcClient\", {configurable: false, enumerable: true, get: function() { return __WEBPACK_IMPORTED_MODULE_5__RpcClient___default.a; }});\n\t/* harmony reexport */ Object.defineProperty(exports, \"AjaxLayer\", {configurable: false, enumerable: true, get: function() { return __WEBPACK_IMPORTED_MODULE_0__AjaxLayer___default.a; }});\n\t/* harmony reexport */ Object.defineProperty(exports, \"LogLayer\", {configurable: false, enumerable: true, get: function() { return __WEBPACK_IMPORTED_MODULE_1__LogLayer___default.a; }});\n\t/* harmony reexport */ Object.defineProperty(exports, \"JsonLayer\", {configurable: false, enumerable: true, get: function() { return __WEBPACK_IMPORTED_MODULE_2__JsonLayer___default.a; }});\n\t/* harmony reexport */ Object.defineProperty(exports, \"HookLayer\", {configurable: false, enumerable: true, get: function() { return __WEBPACK_IMPORTED_MODULE_3__HookLayer___default.a; }});\n\t/* harmony reexport */ Object.defineProperty(exports, \"ProtocolLayer\", {configurable: false, enumerable: true, get: function() { return __WEBPACK_IMPORTED_MODULE_4__ProtocolLayer___default.a; }});\n\t\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** rpc_client.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].e;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\te: {},\n \t\t\ti: moduleId,\n \t\t\tl: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.e, module, module.e, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.e;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap a185735cfd8df0929ddf\n **/","module.e = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"promise\"\n ** module id = 0\n ** module chunks = 0\n **/","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\ndefine(function(require){\n\n\tvar Promise = require('promise');\n\n\t/**\n\t * @param {string} url RPC-server URL\n\t * @constructor\n\t */\n\tfunction AjaxLayer(url){\n\n\t\tthis.send = function(request){\n\n\t\t\treturn new Promise(function(resolve, reject){\n\t\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\t\txhr.open(\"POST\", url, true);\n\t\t\t\txhr.withCredentials = true;\n\n\t\t\t\txhr.onload = function(){\n\t\t\t\t\tif(this.status >= 200 && this.status < 300){\n\t\t\t\t\t\tresolve(xhr.response);\n\t\t\t\t\t}else{\n\t\t\t\t\t\treject({\n\t\t\t\t\t\t\tstatus: this.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\txhr.onerror = function(){\n\t\t\t\t\treject({\n\t\t\t\t\t\tstatus: this.status,\n\t\t\t\t\t\tstatusText: xhr.statusText\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\txhr.send(request);\n\t\t\t});\n\n\t\t}\n\t}\n\n\treturn AjaxLayer;\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/AjaxLayer.js\n ** module id = 1\n ** module chunks = 0\n **/","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\ndefine(function(){\n\n\t/**\n\t * @param protocol_layer\n\t * @param {function} pre_fn\n\t * @param {function} post_fn\n\t * @constructor\n\t */\n\tfunction HookLayer(protocol_layer, pre_fn, post_fn){\n\t\tthis.send = function(calls){\n\t\t\tcalls = pre_fn ? pre_fn(calls) : calls;\n\t\t\tvar promises = protocol_layer.send(calls);\n\t\t\treturn post_fn ? post_fn(promises) : promises;\n\t\t}\n\t}\n\treturn HookLayer;\n\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/HookLayer.js\n ** module id = 2\n ** module chunks = 0\n **/","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\ndefine(function(require){\n\n\tvar Promise = require('promise');\n\n\t/**\n\t *\n\t * @param {object} under_layer\n\t * @constructor\n\t */\n\tfunction JsonLayer(under_layer){\n\n\t\tthis.send = function(request){\n\n\t\t\treturn new Promise(function(resolve, reject){\n\t\t\t\ttry{\n\t\t\t\t\tvar json = JSON.stringify(request);\n\n\t\t\t\t\tunder_layer.send(json).then(function(json_response){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tvar response = JSON.parse(json_response);\n\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\treject({\n\t\t\t\t\t\t\t\tname: \"JsonLayerError\",\n\t\t\t\t\t\t\t\tmessage: e.name + \": \" + e.message + \"\\n\" + json_response\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t}, reject);\n\t\t\t\t}catch(e){\n\t\t\t\t\treject({\n\t\t\t\t\t\tname: \"JsonLayerError\",\n\t\t\t\t\t\tmessage: e.name + \": \" + e.message\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\treturn JsonLayer;\n\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/JsonLayer.js\n ** module id = 3\n ** module chunks = 0\n **/","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\ndefine(function(require){\n\n\t/**\n\t * @param {object} under_layer\n\t * @param {function} log_request_fn\n\t * @param {function} log_response_fn\n\t * @param {function} log_error_fn\n\t * @constructor\n\t */\n\tfunction LogLayer(under_layer, log_request_fn, log_response_fn, log_error_fn){\n\n\t\tthis.send = function(calls){\n\n\t\t\tvar i, call;\n\t\t\tif(log_request_fn){\n\t\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\t\tcall = calls[i];\n\t\t\t\t\tlog_request_fn(\"call[\" + i + \"]\", call[0] + '->' + call[1] + '(' + (call[2] && call[2].join(', ') || '') + ')');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar promises = under_layer.send(calls);\n\n\t\t\tif(log_response_fn || log_error_fn){\n\t\t\t\tvar new_promises = new Array(promises.length);\n\t\t\t\tfor(i = 0; i < promises.length; i++){\n\t\t\t\t\t(function(i){\n\t\t\t\t\t\tnew_promises[i] = promises[i].then(function(response){\n\t\t\t\t\t\t\tlog_response_fn && log_response_fn(\"result[\" + i + \"]\", response);\n\t\t\t\t\t\t\treturn response;\n\t\t\t\t\t\t}, function(error){\n\t\t\t\t\t\t\tvar logger = log_error_fn || log_response_fn;\n\t\t\t\t\t\t\tlogger && logger(\"error[\" + i + \"]\", error);\n\t\t\t\t\t\t\tthrow error;\n\t\t\t\t\t\t})\n\t\t\t\t\t})(i);\n\t\t\t\t}\n\t\t\t\treturn new_promises;\n\t\t\t}else{\n\t\t\t\treturn promises;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn LogLayer;\n\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/LogLayer.js\n ** module id = 4\n ** module chunks = 0\n **/","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\ndefine(function(require){\n\n\tvar Promise = require('promise');\n\n\tfunction extractResult(response){\n\t\tif(typeof response !== \"object\"){\n\t\t\tthrow {name: \"RpcProtocolError\", message: \"Bad response format: object expected, got \" + (typeof response)};\n\t\t}\n\t\tif(response[\"status\"] === undefined){\n\t\t\tthrow {name: \"RpcProtocolError\", message: \"no status\"};\n\t\t}\n\t\tif(response[\"result\"] === undefined){\n\t\t\tthrow {name: \"RpcProtocolError\", message: \"no result\"};\n\t\t}\n\t\tif(!response[\"status\"]){\n\t\t\tthrow {name: response[\"result\"][\"type\"] || \"UnknownError\", message: response[\"result\"][\"message\"] || \"\"};\n\t\t}\n\t\treturn response[\"result\"];\n\t}\n\n\t/**\n\t * @param {object} under_layer\n\t * @constructor\n\t */\n\tfunction ProtocolLayer(under_layer){\n\n\t\tvar id = 1;\n\n\t\tthis.send = function(calls){\n\n\t\t\tvar i, call;\n\t\t\tvar promises = new Array(calls.length);\n\t\t\tvar callbacks = [];\n\t\t\tif(calls.length > 0){\n\n\t\t\t\tvar formed_calls = new Array(calls.length);\n\n\t\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\t\tcall = calls[i];\n\t\t\t\t\tformed_calls[i] = {\n\t\t\t\t\t\tservice: call[0],\n\t\t\t\t\t\tmethod: call[1]\n\t\t\t\t\t};\n\t\t\t\t\tif(call[2] && call[2].length > 0){\n\t\t\t\t\t\tformed_calls[i].parameters = call[2];\n\t\t\t\t\t}\n\t\t\t\t\tpromises[i] = new Promise(function(resolve, reject){\n\t\t\t\t\t\tcallbacks.push([resolve, reject]);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar request = {\n\t\t\t\t\tid: id++,\n\t\t\t\t\tcalls: formed_calls\n\t\t\t\t};\n\n\t\t\t\tunder_layer.send(request).then(function(response){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tvar result = extractResult(response);\n\t\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\tvar r = extractResult(result[i]);\n\t\t\t\t\t\t\t\tcallbacks[i][0](r);\n\t\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, function(e){\n\t\t\t\t\tfor(i = 0; i < callbacks.length; i++){\n\t\t\t\t\t\tcallbacks[i][1](e);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn promises;\n\t\t}\n\n\t}\n\n\treturn ProtocolLayer;\n\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/ProtocolLayer.js\n ** module id = 5\n ** module chunks = 0\n **/","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\ndefine(function(require){\n\n\tvar BatchLayer = require('./BatchLayer');\n\n\t/**\n\t * @param protocol_layer\n\t * @constructor\n\t */\n\tfunction RpcClient(protocol_layer){\n\n\t\tvar client = this;\n\n\t\tclient.call = function(service, method, params){\n\t\t\treturn protocol_layer.send([[service, method, params]])[0];\n\t\t};\n\n\t\tclient.batch = function(callback){\n\t\t\tvar batchLayer = new BatchLayer();\n\t\t\tvar batchClient = new RpcClient(batchLayer);\n\t\t\tcallback(batchClient);\n\t\t\treturn batchLayer.flush(protocol_layer);\n\t\t};\n\n\t}\n\n\treturn RpcClient;\n\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/RpcClient.js\n ** module id = 6\n ** module chunks = 0\n **/","/* author: Ponomarev Denis <ponomarev@gmail.com> */\n\ndefine(function(require){\n\n\tvar Promise = require('promise');\n\n\t/**\n\t * @constructor\n\t */\n\tfunction BatchLayer(){\n\n\t\tvar layer = this;\n\t\tvar i, calls_acc = [], callbacks_acc = [];\n\n\t\tlayer.send = function(calls){\n\t\t\tvar promises = new Array(calls.length);\n\t\t\tcalls_acc = calls_acc.concat(calls);\n\t\t\tfor(i = 0; i < calls.length; i++){\n\t\t\t\tpromises[i] = new Promise(function(resolve, reject){\n\t\t\t\t\tcallbacks_acc.push([resolve, reject]);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn promises;\n\t\t};\n\n\t\tlayer.flush = function(protocol_layer){\n\t\t\tvar promises = protocol_layer.send(calls_acc);\n\t\t\tvar new_promises = new Array(promises.length);\n\t\t\tfor(var i = 0; i < callbacks_acc.length; i++){\n\t\t\t\tnew_promises[i] = promises[i].then(callbacks_acc[i][0], callbacks_acc[1]);\n\t\t\t}\n\t\t\treturn new_promises;\n\t\t};\n\n\t}\n\n\treturn BatchLayer;\n\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/BatchLayer.js\n ** module id = 7\n ** module chunks = 0\n **/","/* author: Ponomarev Denis <ponomarev@gmail.com> */\nimport AjaxLayer from \"./AjaxLayer\";\nimport LogLayer from \"./LogLayer\";\nimport JsonLayer from \"./JsonLayer\";\nimport HookLayer from \"./HookLayer\";\nimport ProtocolLayer from \"./ProtocolLayer\";\nimport RpcClient from \"./RpcClient\";\nexport {AjaxLayer, LogLayer, JsonLayer, HookLayer, ProtocolLayer, RpcClient};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/index.js\n ** module id = 8\n ** module chunks = 0\n **/"],"sourceRoot":""}